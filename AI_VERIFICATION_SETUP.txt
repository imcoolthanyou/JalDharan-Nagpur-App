â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ğŸ”§ AI VERIFICATION SERVICE SETUP GUIDE ğŸ”§
                    Fix Connection Issues & Configure Backend
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ISSUE: "Connection refused" Error
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

This means the app cannot reach your backend server. The most common reasons:

âŒ Wrong IP address in base URL
âŒ Backend server not running
âŒ App and backend not on same network
âŒ Firewall blocking connections

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SOLUTION: Configure Base URL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Option 1: Update in Code (Permanent)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

File: lib/core/services/ai_verification_service.dart
Line: 8

Change from:
  static String _baseUrl = 'http://10.0.2.2:8000';

To your actual backend IP:
  static String _baseUrl = 'http://192.168.1.100:8000';

Replace 192.168.1.100 with your actual backend IP address.

Option 2: Set at Runtime (Temporary)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

In your main.dart or app initialization:

  import 'package:jal_dharan/core/services/ai_verification_service.dart';

  void main() {
    // Set custom base URL before running app
    AIVerificationService.setBaseUrl('http://192.168.1.100:8000');
    runApp(const MyApp());
  }

This is useful for different environments (dev/staging/production).

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FINDING YOUR BACKEND IP ADDRESS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

On Windows (Backend Machine):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Open Command Prompt and run:
  ipconfig

Look for "IPv4 Address" under your network adapter.
Example: 192.168.1.100

On Android Emulator:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

The special address for localhost is:
  http://10.0.2.2:8000

This is the default we've set.

On iOS Simulator:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Use localhost directly:
  http://localhost:8000

On Real Android/iOS Device:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Use your backend machine's IP on the same network:
  http://192.168.x.x:8000

Make sure your device can ping the backend:
  1. Open Settings â†’ Wi-Fi
  2. Connect to same network as backend
  3. Check if devices can communicate

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMPLETE SETUP CHECKLIST:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Before Testing:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â–¡ 1. Check if backend server is running
   - Open terminal/command prompt on backend machine
   - Run: python manage.py runserver (or your backend start command)
   - Should see: "Server running on http://0.0.0.0:8000"

â–¡ 2. Get your backend machine's IP
   - Windows: Run ipconfig
   - Mac/Linux: Run ifconfig
   - Find IPv4 address (e.g., 192.168.1.100)

â–¡ 3. Update base URL in ai_verification_service.dart
   - Change line 8 to use your IP
   - Example: http://192.168.1.100:8000

â–¡ 4. Verify network connectivity
   - Ping backend from your device
   - Make sure firewall allows port 8000

â–¡ 5. Hot reload the app
   - In terminal: flutter run
   - Or in IDE: Press 'r' for hot reload

â–¡ 6. Test the connection
   - Open WaterHeroScreen
   - Select a task and click "Yes"
   - Upload an image
   - Should see verification result

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DIFFERENT ENVIRONMENTS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Development (Your Local Machine):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Backend IP: 192.168.1.100 (your machine's IP)
App IP: Android Emulator or Real Device

  AIVerificationService.setBaseUrl('http://192.168.1.100:8000');

Android Emulator:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Use special emulator IP:
  static String _baseUrl = 'http://10.0.2.2:8000';

iOS Simulator:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Use localhost:
  static String _baseUrl = 'http://localhost:8000';

Real Device on Same Network:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Use your backend machine's IP:
  static String _baseUrl = 'http://192.168.1.100:8000';

Production (Cloud Server):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Use your domain or cloud IP:
  static String _baseUrl = 'http://your-backend.com:8000';

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TESTING THE CONNECTION:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Using Browser (First Test):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Open browser and navigate to:
  http://192.168.1.100:8000/health

You should see:
  - Status: 200 OK
  - Or a health check response

If you see:
  - Error / Connection Refused â†’ Backend not running
  - 404 Not Found â†’ Backend running, but endpoint missing

Using Postman or cURL:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Test the AI verification endpoint:

  POST http://192.168.1.100:8000/ai_verification

  Content-Type: multipart/form-data

  Form Data:
    - image: (select your image file)
    - task: "Clean the solar panel"

Using Flutter App:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Update base URL in ai_verification_service.dart
2. Hot reload app
3. Open WaterHeroScreen
4. Select task and upload image
5. Check error message if it fails

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

COMMON ERRORS & FIXES:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Error: "Connection refused"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Backend server not running or wrong IP
Fix:
  1. Start backend server
  2. Check IP address is correct
  3. Verify firewall allows port 8000

Error: "timeout after 30 seconds"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Server is slow or not responding
Fix:
  1. Check backend server is responsive
  2. Try simpler test (health check)
  3. Increase timeout if server is slow

Error: "Invalid response format"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Backend returning wrong JSON format
Fix:
  1. Check backend API response format
  2. Verify all required fields present
  3. Check backend logs for errors

Error: "404 Not Found"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Cause: Endpoint doesn't exist on backend
Fix:
  1. Verify endpoint path: /ai_verification
  2. Check backend has the route defined
  3. Restart backend after adding route

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DEBUG TIPS:
â•â•â•â•â•â•â•â•â•â•â•â•

Check Current Base URL:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Add this to your code temporarily:

  import 'package:jal_dharan/core/services/ai_verification_service.dart';

  // In your widget:
  print('Current URL: ${AIVerificationService.getBaseUrl()}');

View API Logs:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Backend logs will show:
  - Incoming requests
  - Image processing
  - Verification results
  - Any errors

Check Network Requests:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

In Flutter DevTools:
  1. Open DevTools (F12 or flutter devtools)
  2. Go to Network tab
  3. Try uploading image
  4. See request/response details

Verify Firewall:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Windows Firewall (if blocking):
  1. Open Windows Defender Firewall
  2. Allow Python / your backend app
  3. Ensure port 8000 is open

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP-BY-STEP SETUP:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£  Start Backend Server
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Open terminal on your backend machine:

  # If using Django
  python manage.py runserver 0.0.0.0:8000

  # If using Flask
  python app.py

  # If using FastAPI
  uvicorn main:app --host 0.0.0.0 --port 8000

Should see: "Server running on http://0.0.0.0:8000"

2ï¸âƒ£  Get Backend IP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

On Windows:
  ipconfig

Find: IPv4 Address = 192.168.1.100 (example)

3ï¸âƒ£  Test Backend is Reachable
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

From your phone/emulator:
  - Open browser
  - Navigate to http://192.168.1.100:8000
  - Should load (or show error page, but not connection refused)

4ï¸âƒ£  Update Flutter Code
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

File: lib/core/services/ai_verification_service.dart
Line: 8

Change:
  static String _baseUrl = 'http://10.0.2.2:8000';

To:
  static String _baseUrl = 'http://192.168.1.100:8000';

5ï¸âƒ£  Reload App
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

In terminal:
  flutter run

Or in IDE: Press 'r' for hot reload

6ï¸âƒ£  Test Verification
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Open app
2. Go to WaterHeroScreen
3. Select a task
4. Click "Yes"
5. Take/select a photo
6. Submit
7. Should see verification result (success or failure)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

IF STILL NOT WORKING:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Check backend server is definitely running
   â†’ Look for "Server running" message in terminal

2. Test direct URL in browser
   â†’ http://192.168.1.100:8000/health
   â†’ Should load without error

3. Check network connectivity
   â†’ Ping backend machine: ping 192.168.1.100
   â†’ Should get response (not timeout)

4. Check firewall
   â†’ Temporarily disable to test
   â†’ Then add exceptions for port 8000

5. Check logs
   â†’ Backend logs for errors
   â†’ Flutter logs for full error message

6. Try different IP addresses
   â†’ Maybe machine has multiple IPs
   â†’ Try each one from ipconfig

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

QUICK REFERENCE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

For Android Emulator (Default):
  http://10.0.2.2:8000

For iOS Simulator:
  http://localhost:8000

For Real Device on LAN:
  http://[YOUR_BACKEND_IP]:8000
  Example: http://192.168.1.100:8000

For Cloud/Remote:
  http://your-domain.com:8000

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ready to test! Update your IP and let me know if you get a different error! ğŸš€

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
